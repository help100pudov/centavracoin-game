import{_ as h,u,c as n,a as s,t as i,d as l,b as c,F as m,r as v,o,n as _}from"./index-f7d62f39.js";const g={name:"invite",setup(){return{toast:u()}},data(){return{data:"",refUrl:"",friendsCount:0,friendsOfFriendsCount:0,loading:!1,errorMsg:""}},computed:{user(){return this.$store.state.user},app(){return this.$store.state.app}},created(){this.refUrl=`https://t.me/centavracoin_bot?start=${btoa(this.user.user)}`,this.updateFriendsCount()},watch:{"app.friends":{handler:"updateFriendsCount",deep:!0}},methods:{updateFriendsCount(){this.app.friends&&(this.friendsCount=this.app.friends.length,this.friendsOfFriendsCount=this.app.friends.reduce((t,e)=>t+(e.refAll||0),0))},async copyRefLink(){let t=this.refUrl;try{if(!navigator.clipboard){this.toast.error("Clipboard API not available");return}await navigator.clipboard.writeText(t),this.toast.success("Link copied to clipboard!")}catch(e){this.toast.error(`Failed to copy: ${e}`),this.logError("copyRefLink",e)}},sendMessage(){const t="Play with me, join the ranks of Centavra!.",e=`https://t.me/share/url?url=${encodeURIComponent(this.refUrl)}&text=${encodeURIComponent(t)}`;window.open(e,"_blank")},goToFriend(t){this.$router.push({path:`/invitingfriends/${t}`})},async fetchLeaderboard(){this.loading=!0,this.errorMsg="";try{await this.$store.dispatch("fetchFriendsLeaderboard"),!this.app.friendsLeaderboard||!this.app.friendsLeaderboard.length?this.toast.info(this.$t("No friends found!")):this.toast.success(this.$t("Friends leaderboard loaded!"))}catch(t){this.errorMsg=this.$t("Failed to load friends leaderboard"),this.toast.error(this.errorMsg),this.logError("fetchLeaderboard",t)}this.loading=!1},async logError(t,e){try{await fetch("/api/log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:t,error:(e==null?void 0:e.message)||e})})}catch{}}},mounted(){this.fetchLeaderboard()}},y={class:"pl-4 pr-4 pb-2"},b={class:"card p-4 mt-4 mb-4"},x={class:"flexCenter"},C={class:"text-center fs-14px text-light mt-2 pl-3 pr-3"},$={class:"flexCenter g-5 m-0"},k={class:"card w-50 text-center p-3"},w={class:"flexCenter mt-1"},F={class:"card w-50 text-center p-3"},L={class:"flexCenter mt-1"},M={class:"card p-4 mt-4",style:{"margin-bottom":"60px"}},T={class:"text-center"},U={class:"text-center fs-14px text-light mt-2 pl-3 pr-3"},I={key:0,class:"text-center mt-3"},R={key:1,class:"text-center text-danger mt-3"},N={key:2},O={class:"card p-3 mt-5"},B={class:""},E=["onClick"],S={class:"d-flex items-center w-80"},A={class:"flexCenter"},P={class:"ml-3"},V={class:"fs-16px fw-700"},Y={class:"d-flex items-center fs-14px"},j={class:"ml-2"},z={class:"ml-1"},D={class:"ml-1"},H={class:"ml-1"},J={class:""},q={key:3,class:"card text-center p-4 mt-3"},G={class:"footer"},K={class:"flexCenter g-4 mb-2 pl-4 pr-4"},Q={class:"w-80"},W={class:"w-20"};function X(t,e,p,Z,d,a){return o(),n("div",null,[s("div",y,[s("div",b,[s("h3",x,i(t.$t("Invite friends")),1),s("div",C,i(t.$t("You can see your friends and your friends' friends. From each friend you invite you get 10%, from his friends - 5%, and from friends of friends - 1%. Share your referral link and increase your income!")),1)]),s("div",$,[s("div",k,[e[3]||(e[3]=s("h4",{class:""},"10%",-1)),e[4]||(e[4]=s("hr",{class:"m-2"},null,-1)),s("div",null,i(t.$t("My friends")),1),s("div",w,[e[2]||(e[2]=s("i",{class:"bi bi-person fs-18px mr-2"},null,-1)),l(" "+i(t.$num(d.friendsCount)),1)])]),s("div",F,[e[6]||(e[6]=s("h4",{class:""},"5%",-1)),e[7]||(e[7]=s("hr",{class:"m-2"},null,-1)),s("div",null,i(t.$t("Friends of friends")),1),s("div",L,[e[5]||(e[5]=s("i",{class:"bi bi-person fs-18px mr-2"},null,-1)),l(" "+i(t.$num(d.friendsOfFriendsCount)),1)])])]),s("div",M,[s("h3",T,i(t.$t("Your friends")),1),s("div",U,i(t.$t("This section displays statistics about your invitations. Here you see the number of invited friends, friends of your friends and your total earnings from their activity")),1),d.loading?(o(),n("div",I,i(t.$t("Loading...")),1)):c("",!0),d.errorMsg?(o(),n("div",R,i(d.errorMsg),1)):c("",!0),a.app.friendsLeaderboard&&a.app.friendsLeaderboard.length?(o(),n("div",N,[s("div",O,[s("h4",B,i(t.$t("Friends leaderboard")),1),(o(!0),n(m,null,v(a.app.friendsLeaderboard,(r,f)=>(o(),n("div",{class:"card p-1 pl-4 pr-4 mt-1 flexBetween friend-row",key:r.id,onClick:ss=>a.goToFriend(r.id),style:{cursor:"pointer"}},[s("div",S,[s("div",A,[s("div",null,[s("i",{class:_(["icon x40 br-50",`i-ava${r.ava}`])},null,2)]),s("div",P,[s("div",V,i(r.first.slice(0,8))+" "+i(r.last.charAt(0)),1),s("div",Y,[e[12]||(e[12]=s("i",{class:"icon i-centa x16 mr-1"},null,-1)),s("div",null,i(t.$num(r.centa)),1),s("span",j,[e[8]||(e[8]=s("i",{class:"icon-copper"},null,-1)),l(" "+i(r.copper),1)]),s("span",z,[e[9]||(e[9]=s("i",{class:"icon-gold"},null,-1)),l(" "+i(r.gold),1)]),s("span",D,[e[10]||(e[10]=s("i",{class:"icon-silver"},null,-1)),l(" "+i(r.silver),1)]),s("span",H,[e[11]||(e[11]=s("i",{class:"icon-iron"},null,-1)),l(" "+i(r.iron),1)])])])])]),s("div",null,[s("h6",J,"#"+i(f+1),1)])],8,E))),128))])])):d.loading?c("",!0):(o(),n("div",q,i(t.$t("You haven't invited anyone yet")),1))])]),s("div",G,[s("div",K,[s("div",Q,[s("button",{onClick:e[0]||(e[0]=r=>a.sendMessage()),class:"btn",style:{height:"50px"}},i(t.$t("Invite friends")),1)]),s("div",W,[s("button",{onClick:e[1]||(e[1]=r=>a.copyRefLink()),class:"btn light p-2",style:{height:"50px"}},[...e[13]||(e[13]=[s("i",{class:"bi bi-copy fs-32px text-white"},null,-1)])])])])])])}const ts=h(g,[["render",X],["__scopeId","data-v-3c4a74e0"]]);export{ts as default};
